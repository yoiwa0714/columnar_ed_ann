# ハイパーパラメータ設定
# 最終更新: 2025-12-28

layer_params:
  1:  # 1層構成
    hidden: [512]
    learning_rate: 0.10
    u1: 1.0
    u2: 1.5
    lateral_lr: 0.08
    column_radius: 0.4
    column_radius_per_layer: [0.57]  # [sqrt(512/256) * 0.4]
    participation_rate: 0.71
    weight_init_scales: [1.25, 2.0]  # [Layer 0, 出力層]
    epochs: 80
    # 実験結果: 87.60% (Epoch 21, 2025-12-28)
    # 訓練データ: 3000, テストデータ: 1000
    # lateral_lr: 0.01と0.08で同等の性能を確認
    description: '1層構成、2層最適パラメータから推定（2025-12-28）'
    
  2:  # 2層構成
    hidden: [512, 256]
    learning_rate: 0.1
    u1: 1.0
    u2: 1.5
    lateral_lr: 0.08
    column_radius: 0.4
    column_radius_per_layer: [0.57, 0.40]  # [sqrt(512/256) * 0.4, sqrt(256/256) * 0.4]
    participation_rate: 0.1
    weight_init_scales: [1.1, 1.2, 0.6]  # [Layer 0, Layer 1, 出力層]
    epochs: 80
    # 実験結果: 84.53% (Best Epoch, 2025-12-30)
    # グリッドサーチ最適化結果:
    #   - participation_rate: 0.71 → 0.1 (+1.47%)
    #   - weight_init_scales: [1.25, 1.75, 2.0] → [1.1, 1.2, 0.6] (+0.06%)
    #   - 総改善: 83.40% → 84.53% (+1.13%)
    # 訓練データ: 60000, テストデータ: 10000
    description: '2層最適構成、512,256、84.53%達成（2025-12-30、PR/WIS最適化完了）'
    
  3:  # 3層構成（最適化予定）
    hidden: [256, 128, 64]
    learning_rate: 0.35
    u1: 0.5
    u2: 0.5
    lateral_lr: 0.08
    column_radius: 1.0
    column_radius_per_layer: [1.0, 0.71, 0.50]
    participation_rate: 1.0
    weight_init_scales: null  # 未最適化（デフォルト値使用）
    epochs: 50
    description: '3層標準構成（最適化予定、現在25.8%）'
    
  4:  # 4層構成（最適化予定）
    hidden: [256, 128, 96, 64]
    learning_rate: 0.35
    u1: 0.5
    u2: 0.5
    lateral_lr: 0.08
    column_radius: 1.0
    column_radius_per_layer: [1.0, 0.71, 0.61, 0.50]
    participation_rate: 1.0
    weight_init_scales: null  # 未最適化（デフォルト値使用）
    epochs: 50
    description: '4層標準構成（最適化予定）'
    
  5:  # 5層構成（最適化予定）
    hidden: [256, 128, 96, 80, 64]
    learning_rate: 0.35
    u1: 0.5
    u2: 0.5
    lateral_lr: 0.08
    column_radius: 1.0
    column_radius_per_layer: [1.0, 0.71, 0.61, 0.56, 0.50]
    participation_rate: 1.0
    weight_init_scales: null  # 未最適化（デフォルト値使用）
    epochs: 50
    description: '5層標準構成（最適化予定）'

# 共通パラメータ（層数非依存）
common_params:
  w1: 1.0  # 重み初期化範囲
  column_overlap: 0.1
  column_ratio: 0.2
  time_loops: 2
  dataset: 'mnist'
  train_samples: 10000
  test_samples: 2000
